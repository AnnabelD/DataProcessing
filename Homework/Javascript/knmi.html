<!DOCTYPE html>

<!-- 
Webpage that shows the average temperature for the year 2014 
Annabel Droste
11122439 --> 

<html>
    <head>
        <style>
            body {
                background-color: #DFFFFF;
            }
            
            #canvas {
                background-color: white;
                margin: 0 auto;
                position: absolute;
                top: 10%;
                left: 15%;
                
            }
            
            #cross {
                position: absolute;
                margin: 0 auto;
                top: 10%;
                left: 15%;
            }
            
            #rawdata {
                visibility: hidden;
                position: absolute;
            }
        </style>
        <title>
            Weeroverzicht 2014
        </title>
        <h1 align="center">
            Gemiddelde Temperatuur 2014
        </h1>
    </head>
    <body>
        <textarea id="rawdata">
            2014/01/01,   71
            2014/01/02,   87
            2014/01/03,   88
            2014/01/04,   73
            2014/01/05,   61
            2014/01/06,  113
            2014/01/07,  108
            2014/01/08,   8
            2014/01/09,   94
            2014/01/10,   65
            2014/01/11,   51
            2014/01/12,   20
            2014/01/13,   61
            2014/01/14,   48
            2014/01/15,   45
            2014/01/16,   75
            2014/01/17,   74
            2014/01/18,   70
            2014/01/19,   60
            2014/01/20,   37
            2014/01/21,   39
            2014/01/22,   33
            2014/01/23,   30
            2014/01/24,   45
            2014/01/25,   39
            2014/01/26,   54
            2014/01/27,   41
            2014/01/28,   46
            2014/01/29,    1
            2014/01/30,    6
            2014/01/31,   31
            2014/02/01,   64
            2014/02/02,   51
            2014/02/03,   39
            2014/02/04,   58
            2014/02/05,   74
            2014/02/06,   78
            2014/02/07,   76
            2014/02/08,   69
            2014/02/09,   59
            2014/02/10,   51
            2014/02/11,   60
            2014/02/12,   58
            2014/02/13,   49
            2014/02/14,   51
            2014/02/15,  100
            2014/02/16,   57
            2014/02/17,   60
            2014/02/18,   60
            2014/02/19,   78
            2014/02/20,   82
            2014/02/21,   70
            2014/02/22,   66
            2014/02/23,   75
            2014/02/24,   78
            2014/02/25,   87
            2014/02/26,   67
            2014/02/27,   49
            2014/02/28,   54
            2014/03/01,   59
            2014/03/02,   62
            2014/03/03,   49
            2014/03/04,   52
            2014/03/05,   56
            2014/03/06,   65
            2014/03/07,   78
            2014/03/08,   87
            2014/03/09,  113
            2014/03/10,   98
            2014/03/11,   93
            2014/03/12,   83
            2014/03/13,   79
            2014/03/14,   67
            2014/03/15,   99
            2014/03/16,  105
            2014/03/17,  102
            2014/03/18,   93
            2014/03/19,  113
            2014/03/20,  129
            2014/03/21,   78
            2014/03/22,   66
            2014/03/23,   52
            2014/03/24,   56
            2014/03/25,   48
            2014/03/26,   45
            2014/03/27,   86
            2014/03/28,  110
            2014/03/29,  115
            2014/03/30,  123
            2014/03/31,  147
            2014/04/01,  127
            2014/04/02,  137
            2014/04/03,  152
            2014/04/04,  130
            2014/04/05,  119
            2014/04/06,  131
            2014/04/07,  156
            2014/04/08,   91
            2014/04/09,  107
            2014/04/10,  121
            2014/04/11,  113
            2014/04/12,   99
            2014/04/13,  105
            2014/04/14,   89
            2014/04/15,   72
            2014/04/16,   74
            2014/04/17,  109
            2014/04/18,   86
            2014/04/19,  112
            2014/04/20,  155
            2014/04/21,  124
            2014/04/22,  125
            2014/04/23,  134
            2014/04/24,  136
            2014/04/25,  171
            2014/04/26,  142
            2014/04/27,  116
            2014/04/28,  132
            2014/04/29,  138
            2014/04/30,  131
            2014/05/01,  130
            2014/05/02,  100
            2014/05/03,   84
            2014/05/04,   79
            2014/05/05,  122
            2014/05/06,  146
            2014/05/07,  127
            2014/05/08,  122
            2014/05/09,  125
            2014/05/10,  116
            2014/05/11,  102
            2014/05/12,  108
            2014/05/13,  103
            2014/05/14,   96
            2014/05/15,  101
            2014/05/16,  121
            2014/05/17,  142
            2014/05/18,  159
            2014/05/19,  184
            2014/05/20,  199
            2014/05/21,  181
            2014/05/22,  182
            2014/05/23,  164
            2014/05/24,  150
            2014/05/25,  160
            2014/05/26,  158
            2014/05/27,  156
            2014/05/28,  131
            2014/05/29,  104
            2014/05/30,  119
            2014/05/31,  133
            2014/06/01,  135
            2014/06/02,  140
            2014/06/03,  151
            2014/06/04,  146
            2014/06/05,  130
            2014/06/06,  163
            2014/06/07,  210
            2014/06/08,  200
            2014/06/09,  216
            2014/06/10,  204
            2014/06/11,  175
            2014/06/12,  171
            2014/06/13,  178
            2014/06/14,  160
            2014/06/15,  156
            2014/06/16,  148
            2014/06/17,  153
            2014/06/18,  149
            2014/06/19,  142
            2014/06/20,  140
            2014/06/21,  160
            2014/06/22,  153
            2014/06/23,  154
            2014/06/24,  160
            2014/06/25,  147
            2014/06/26,  167
            2014/06/27,  175
            2014/06/28,  171
            2014/06/29,  160
            2014/06/30,  141
            2014/07/01,  142
            2014/07/02,  150
            2014/07/03,  184
            2014/07/04,  216
            2014/07/05,  199
            2014/07/06,  190
            2014/07/07,  181
            2014/07/08,  152
            2014/07/09,  156
            2014/07/10,  216
            2014/07/11,  200
            2014/07/12,  190
            2014/07/13,  187
            2014/07/14,  184
            2014/07/15,  173
            2014/07/16,  195
            2014/07/17,  219
            2014/07/18,  251
            2014/07/19,  264
            2014/07/20,  221
            2014/07/21,  195
            2014/07/22,  226
            2014/07/23,  232
            2014/07/24,  215
            2014/07/25,  185
            2014/07/26,  209
            2014/07/27,  212
            2014/07/28,  195
            2014/07/29,  212
            2014/07/30,  184
            2014/07/31,  188
            2014/08/01,  203
            2014/08/02,  205
            2014/08/03,  196
            2014/08/04,  184
            2014/08/05,  177
            2014/08/06,  176
            2014/08/07,  182
            2014/08/08,  185
            2014/08/09,  191
            2014/08/10,  182
            2014/08/11,  171
            2014/08/12,  163
            2014/08/13,  167
            2014/08/14,  162
            2014/08/15,  155
            2014/08/16,  161
            2014/08/17,  149
            2014/08/18,  138
            2014/08/19,  124
            2014/08/20,  126
            2014/08/21,  138
            2014/08/22,  136
            2014/08/23,  127
            2014/08/24,  125
            2014/08/25,  127
            2014/08/26,  137
            2014/08/27,  142
            2014/08/28,  172
            2014/08/29,  173
            2014/08/30,  163
            2014/08/31,  151
            2014/09//01,  153
            2014/09//02,  167
            2014/09//03,  163
            2014/09//04,  177
            2014/09//05,  176
            2014/09//06,  166
            2014/09//07,  170
            2014/09//08,  141
            2014/09//09,  145
            2014/09//10,  139
            2014/09//11,  159
            2014/09//12,  156
            2014/09//13,  170
            2014/09//14,  157
            2014/09//15,  168
            2014/09//16,  175
            2014/09//17,  180
            2014/09//18,  193
            2014/09//19,  178
            2014/09//20,  178
            2014/09//21,  158
            2014/09//22,  134
            2014/09//23,  126
            2014/09//24,  130
            2014/09//25,  142
            2014/09//26,  153
            2014/09//27,  133
            2014/09//28,  147
            2014/09//29,  160
            2014/09//30,  162
            2014/10/01,  159
            2014/10/02,  157
            2014/10/03,  150
            2014/10/04,  156
            2014/10/05,  132
            2014/10/06,  138
            2014/10/07,  122
            2014/10/08,  132
            2014/10/09,  150
            2014/10/10,  134
            2014/10/11,  113
            2014/10/12,  119
            2014/10/13,  151
            2014/10/14,  124
            2014/10/15,  137
            2014/10/16,  142
            2014/10/17,  146
            2014/10/18,  173
            2014/10/19,  171
            2014/10/20,  151
            2014/10/21,  112
            2014/10/22,  100
            2014/10/23,  124
            2014/10/24,  116
            2014/10/25,  126
            2014/10/26,  127
            2014/10/27,  127
            2014/10/28,   99
            2014/10/29,  110
            2014/10/30,  130
            2014/10/31,  135
            2014/11/01,  141
            2014/11/02,  148
            2014/11/03,  125
            2014/11/04,   89
            2014/11/05,   60
            2014/11/06,   61
            2014/11/07,   77
            2014/11/08,   98
            2014/11/09,   95
            2014/11/10,   96
            2014/11/11,   95
            2014/11/12,   93
            2014/11/13,   79
            2014/11/14,  103
            2014/11/15,   97
            2014/11/16,   84
            2014/11/17,   95
            2014/11/18,   79
            2014/11/19,   80
            2014/11/20,   71
            2014/11/21,   52
            2014/11/22,   83
            2014/11/23,  106
            2014/11/24,   65
            2014/11/25,   41
            2014/11/26,   49
            2014/11/27,   74
            2014/11/28,   63
            2014/11/29,   28
            2014/11/30,   25
            2014/12/01,   15
            2014/12/02,    6
            2014/12/03,  -12
            2014/12/04,   -3
            2014/12/05,   35
            2014/12/06,   32
            2014/12/07,   34
            2014/12/08,   32
            2014/12/09,   22
            2014/12/10,   65
            2014/12/11,   65
            2014/12/12,   75
            2014/12/13,   47
            2014/12/14,   25
            2014/12/15,   56
            2014/12/16,   52
            2014/12/17,   80
            2014/12/18,  115
            2014/12/19,   94
            2014/12/20,   77
            2014/12/21,   78
            2014/12/22,  114
            2014/12/23,  111
            2014/12/24,   81
            2014/12/25,   52
            2014/12/26,   19
            2014/12/27,    7
            2014/12/28,   -9
            2014/12/29,   35
            2014/12/30,   50
            2014/12/31,   52
        </textarea>
        
        <canvas id="canvas">
            Graph of average temperatures of 2014
        </canvas>
        
        <canvas id="cross">
            Mouse-pointer
        </canvas>
        
        <script>
            function createTransform(domain, range){
             	var alpha = (range[1] - range[0])/(domain[1] - domain[0]);
            	var beta =  range[1] - alpha * domain[1];
            	
            	return function(x){
            		return alpha * x + beta;
            	};
            }
            
            var months = ["January", "February", "March", "April", "May", "June", "July", 
            "August", "September", "October", "November", "December"];
            var timeMonths = ['2014/01/01', '2014/02/01', '2014/03/01', '2014/04/01', 
            '2014/05/01', '2014/06/01', '2014/07/01', '2014/08/01', '2014/09/01',
            '2014/10/01', '2014/11/01', '2014/12/01'];
            
            var data = document.getElementById("rawdata").innerHTML;
            var rows = data.split("\n");
            var dates = new Array();
            for (var i = 0, l = rows.length; i < l; i++)
            {
                dates.push(rows[i].split(","));
            }
            var date = new Array();
            var temp = new Array();
           
            for (var j = 0, len = dates.length; j < len - 1; j++)
            {
                date.push(new Date(dates[j][0]).getTime());
                temp.push(dates[j][1] / 10);
            }
            var canvas = document.getElementById("canvas");
            var ctx = canvas.getContext('2d');
            var graphHeight = 300;
            var graphWidth = 900;
            canvas.height = graphHeight;
            canvas.width = graphWidth;
            var labelwidth = 25;
            var labelheight = 25;
            var domain = [date[0], date[date.length - 1]];
            var range = [Math.min(...temp), Math.max(...temp)];
            var transformdate = createTransform(domain, [labelwidth, canvas.width]);
            var transformtemp = createTransform(range, [labelheight, canvas.height]);
            
            
            ctx.beginPath();
            ctx.strokeStyle = 'black';
            
            // draw labelline/scalebar
            ctx.moveTo(labelwidth, canvas.height - labelheight);
            ctx.lineTo(canvas.width, canvas.height - labelheight);
            ctx.moveTo(labelwidth,0);
            ctx.lineTo(labelwidth, canvas.height - labelheight);
            ctx.moveTo(transformdate(date[0]),graphHeight - transformtemp(temp[0]));
            
            // draw data
            for (var point = 0, total = temp.length; point < total; point++)
            {
                var x = transformdate(date[point]);
                var y = graphHeight - transformtemp(temp[point]);
                ctx.lineTo(x, y);
            }
            
            // put labels
            // y-axis
            for (var lmin = Math.floor(~~Math.min(...temp)), lmax= Math.floor(Math.max(...temp)); lmin < lmax; lmin += 5)
            {
                ctx.fillText(lmin + "*C", 0, graphHeight - transformtemp(lmin), 16);
                ctx.moveTo(20, graphHeight - transformtemp(lmin));
                ctx.lineTo(labelwidth, graphHeight - transformtemp(lmin));
            }
            ctx.stroke();
            ctx.closePath();
            
            // x-axis
            ctx.beginPath();
            for (var month = 0, year = timeMonths.length; month < year; month++)
            {
                x = transformdate(new Date(timeMonths[month]).getTime());
                y = graphHeight;
                ctx.fillText(months[month], x, y);
                ctx.moveTo(x, graphHeight - labelheight + 10);
                ctx.lineTo(x, graphHeight - labelheight);
            }
            ctx.stroke();
            
            // draw 0 line
            ctx.beginPath();
            ctx.strokeStyle = 'blue';
            ctx.moveTo(labelwidth, graphHeight - transformtemp(0));
            ctx.lineTo(canvas.width, graphHeight - transformtemp(0));
            ctx.fillStyle = 'blue';
            ctx.fillText(0, 15, graphHeight - transformtemp(0) + 2);
            ctx.stroke();
            ctx.closePath();
            
            // notice mouseposition and show cross
            var cross = document.getElementById("cross");
            var crosstx = cross.getContext('2d');
            cross.height = graphHeight;
            cross.width = graphWidth;
            var cross_l_pos = cross.getBoundingClientRect().left;
            var cross_r_pos = cross.getBoundingClientRect().right;
            var cross_t_pos = cross.getBoundingClientRect().top;
            var scale_x = (graphWidth - labelwidth) / date.length;

            function drawCross(x){
                crosstx.clearRect(0, 0, graphWidth, graphHeight);
                var x_coor = x.clientX - cross_l_pos;
                var y_coor = x.clientY - cross_t_pos;
                if (y_coor < graphHeight - labelheight && x_coor > labelwidth)
                {
                    crosstx.beginPath();
                    crosstx.strokeStyle = 'green';
                    crosstx.moveTo(x_coor, 0);
                    crosstx.lineTo(x_coor, graphHeight - labelheight);
                    var index = Math.round(x_coor / scale_x);
                    console.log(temp[index]);
                    crosstx.moveTo(labelwidth, graphHeight - transformtemp(temp[index - 10]));
                    crosstx.lineTo(cross_r_pos, graphHeight - transformtemp(temp[index- 10]));
                    crosstx.stroke();
                }
            }
            
            cross.addEventListener('mousemove', drawCross, true);
            
        </script>
    </body>
</html>